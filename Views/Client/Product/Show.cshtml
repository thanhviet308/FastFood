@model IEnumerable<FastFoodShop.Domain.Entities.Product>
@{
    ViewData["Title"] = "Th·ª±c ƒê∆°n - FastFood Shop";
    Layout = null;
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <title>@ViewData["Title"]</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    
    <!-- Bootstrap -->
    <link href="~/client/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Minimal Theme -->
    <link href="~/client/css/minimal-theme.css" rel="stylesheet" />
</head>
<body>
    @await Html.PartialAsync("~/Views/Client/Layout/_Header.cshtml")

    <!-- Page Header - Minimal -->
    <section class="py-5 bg-light border-bottom">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="fw-bold mb-2">
                        <i class="fas fa-utensils me-3 minimal-text-primary"></i>Th·ª±c ƒê∆°n
                    </h1>
                    <p class="text-muted mb-0">Kh√°m ph√° h√†ng trƒÉm m√≥n ƒÉn ngon t·∫°i FastFood Shop</p>
                </div>
                <div class="col-lg-4 text-lg-end">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb justify-content-lg-end mb-0">
                            <li class="breadcrumb-item"><a href="/" class="text-decoration-none">Trang ch·ªß</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Th·ª±c ƒë∆°n</li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section - Minimal -->
    <section class="py-5">
        <div class="container">
            <!-- Filter Section -->
            <div class="row mb-5">
                <div class="col-lg-12">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body p-4">
                            <div class="row align-items-center">
                                <div class="col-md-6">
                                    <h5 class="mb-3 mb-md-0">
                                        <i class="fas fa-filter me-2 minimal-text-primary"></i>
                                        L·ªçc theo danh m·ª•c
                                    </h5>
                                </div>
                                <div class="col-md-6">
                                    <div class="minimal-filters justify-content-md-end">
                                        <a href="/products" class="minimal-filter-btn active">T·∫•t c·∫£</a>
                                        <a href="/products?category=burger" class="minimal-filter-btn">Burger</a>
                                        <a href="/products?category=pizza" class="minimal-filter-btn">Pizza</a>
                                        <a href="/products?category=chicken" class="minimal-filter-btn">G√† r√°n</a>
                                        <a href="/products?category=drinks" class="minimal-filter-btn">ƒê·ªì u·ªëng</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Products Grid -->
            <div class="row g-4">
                @foreach (var p in Model ?? Enumerable.Empty<FastFoodShop.Domain.Entities.Product>())
                {
                    // Get variants for this product from ViewBag
                    var allVariants = ViewBag.Variants as List<FastFoodShop.Domain.Entities.ProductVariant> ?? new List<FastFoodShop.Domain.Entities.ProductVariant>();
                    var variants = allVariants.Where(v => v.ProductId == p.Id).ToList();
                    
                    <div class="col-lg-3 col-md-4 col-sm-6">
                        <div class="minimal-product-card">
                            <div class="minimal-product-image">
                                @if (!string.IsNullOrEmpty(p.Image))
                                {
                                    <img src="~/images/product/@p.Image" alt="@p.Name" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                                    <div style="display: none;">üçî</div>
                                }
                                else
                                {
                                    <div>üçî</div>
                                }
                            </div>
                            <div class="minimal-product-body">
                                <h5 class="minimal-product-title">@p.Name</h5>
                                <p class="minimal-product-desc">@p.ShortDesc</p>
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div class="minimal-product-price">
                                        @if (variants.Any())
                                        {
                                            <span>@variants.First().Price.ToString("N0")‚Ç´</span>
                                        }
                                        else
                                        {
                                            <span>Li√™n h·ªá</span>
                                        }
                                    </div>
                                    <div class="text-warning">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <small class="text-muted ms-1">(4.8)</small>
                                    </div>
                                </div>
                                <div class="minimal-product-actions">
                                    <a href="/product/@p.Id" class="minimal-btn minimal-btn-outline">Xem</a>
                                    <button class="btnAddToCartHomepage minimal-btn minimal-btn-primary" 
                                            data-product-id="@p.Id">
                                        Th√™m
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>

            <!-- Empty State -->
            @if (Model == null || !Model.Any())
            {
                <div class="col-12">
                    <div class="minimal-empty">
                        <div class="minimal-empty-icon">üçΩÔ∏è</div>
                        <h3>Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o</h3>
                        <p>Hi·ªán t·∫°i ch∆∞a c√≥ m√≥n ƒÉn n√†o trong danh m·ª•c n√†y.</p>
                        <a href="/" class="minimal-btn minimal-btn-primary">
                            <i class="fas fa-home me-2"></i>V·ªÅ trang ch·ªß
                        </a>
                    </div>
                </div>
            }
        </div>
    </section>

    @await Html.PartialAsync("~/Views/Client/Layout/_Footer.cshtml")
    
    <!-- Scripts -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Simple cart functionality
        document.addEventListener('DOMContentLoaded', function() {
            const cartButtons = document.querySelectorAll('.btnAddToCartHomepage');
            cartButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const productId = this.getAttribute('data-product-id');
                    // Add to cart logic here
                    this.innerHTML = '<i class="fas fa-check me-1"></i>ƒê√£ th√™m';
                    this.classList.remove('minimal-btn-primary');
                    this.classList.add('minimal-btn-outline');
                    setTimeout(() => {
                        this.innerHTML = 'Th√™m';
                        this.classList.remove('minimal-btn-outline');
                        this.classList.add('minimal-btn-primary');
                    }, 2000);
                });
            });
        });
    </script>
</body>
</html>